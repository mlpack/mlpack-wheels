env:
  global:
    - BUILD_COMMIT=mlpack-3.1.1
    - BUILD_DEPENDS="Cython numpy pandas"
    - TEST_DEPENDS="Cython numpy pandas" # Not sure, but probably ok.
    - PLAT=x86_64
    - UNICODE_WIDTH=32
    - WHEELHOUSE_UPLOADER_USERNAME=mlpack-travis-worker
  secure: "Yqwghu5iJh8JWky39IJl8jbi5vJy0RdWX9PnXLdnvSLbSf0AoZXkBzeIYTZeFAoVwFpWecsE5+oovAwlZmF+TEe7M/nuVZ4gxEF0DQbzqWdnEUu8EB8qRHi37lzCcOvAA71vWinEbnHuRvodJCZ5Bw9BfDB4QvBAU6SwQXo92bn7oo3BDK9IYx0+tCclXghu8HELILFx4RZynrMJutU10X4GcEkGpc7BacgWmuOHN0hBP3lLf31fycpneZAsYZV9lV77kTmcY/0vyNgJx33Gi9aOjDC8HMt+oGFZJ5cy0kGkKei1lz7kKA8nWxKCLR+qyO86v+4iqFR53wmOEmtmuHgWr9ca7EJ1DkVN+SnJIBgo9yvMObYL5fZ32v9hBwgJEdheinO09eK/KbEjDbLMO7ji5TEejb2ysyUXV2l94FKhanvAR5UDwCZ2A4GkD1w6XLGqfJ2ZOi0G1Eg6/c7U+8BdUS9cv12Rxeid25CV/yAe6E3oDZiCxabTRsZPu6Kt9Vq2FqXOCRYXIhvUitT2EdWOJjPM7alHILB29ifUvWz0TigxoXkBYgSMuKVNYSYkfsanHWnMDxkXMxV9nqYV+f8oIxuDxpGU2IfAHiunLAZGRFtN32erNfKnF9ssyqXdw1lZDWJ1DrtBMrhuLVpIP0ukoQDOZZTrSU/I1lmny6w="

language: python
python: 3.5
dist: trusty
services: docker

matrix:
  exclude:
    # Exclude the default Python 3.5 build.
    - python: 3.5

  include:
    - os: linux
      env: MB_PYTHON_VERSION=2.7

    - os: linux
      env:
        - MB_PYTHON_VERSION=2.7
        - UNICODE_WIDTH=16

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=2.7
#        - PLAT=i686

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=2.7
#        - PLAT=i686
#        - UNICODE_WIDTH=16

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.4

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.4
#        - PLAT=i686

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.5

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.5
#        - PLAT=i686

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.6

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.6
#        - PLAT=i686

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.7

#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.7
#        - PLAT=i686

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=2.7

#    - os: osx
#      env:
#        - MB_PYTHON_VERSION=2.7
#        - MB_PYTHON_OSX_VER=10.9

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.4

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.5

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.6

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.7
#        - MB_PYTHON_OSX_VER=10.9

#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=pypy-5.7

before_install:
  - source multibuild/common_utils.sh
  - source multibuild/travis_steps.sh
  - before_install

install:
  - clean_code mlpack $BUILD_COMMIT
  - build_wheel /io/mlpack/build/src/mlpack/bindings/python $PLAT
  - pip install --upgrade twine
  - twine upload --repository-url https://test.pypi.org/legacy/ -u mlpack-travis-worker -p "$PYPI_PASSWORD" --skip-existing wheelhouse/mlpack3*

script:
  - install_run $PLAT

after_success:
  - echo "hooray!"
